<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>The Settings Matrix</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">The Settings Matrix</h1>


<div id="TOC">
<ul>
<li><a href="#the-basic-settings_matrix" id="toc-the-basic-settings_matrix">The basic settings_matrix</a></li>
<li><a href="#adding-random-rows" id="toc-adding-random-rows">Adding
random rows</a></li>
<li><a href="#alpha-k-and-t" id="toc-alpha-k-and-t">Alpha, k, and
t</a></li>
<li><a href="#inclusion-columns" id="toc-inclusion-columns">Inclusion
columns</a></li>
<li><a href="#grid-searching" id="toc-grid-searching">Grid
searching</a></li>
<li><a href="#assembling-a-settings_matrix-in-pieces" id="toc-assembling-a-settings_matrix-in-pieces">Assembling a
settings_matrix in pieces</a></li>
<li><a href="#manual-adjustments" id="toc-manual-adjustments">Manual
adjustments</a></li>
<li><a href="#matrix-building-failed" id="toc-matrix-building-failed">“Matrix building failed”</a></li>
</ul>
</div>

<p>Download a copy of the vignette to follow along here: <a href="https://raw.githubusercontent.com/BRANCHlab/metasnf/main/vignettes/settings_matrix.Rmd">settings_matrix.Rmd</a></p>
<p>This vignette outlines the main functionality of the
<code>generate_settings_matrix</code> function.</p>
<div id="the-basic-settings_matrix" class="section level2">
<h2>The basic settings_matrix</h2>
<p>The most minimal settings_matrix can be obtained by providing a
data_list object.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(metasnf)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># It&#39;s best to list out the individual elements with names, i.e. data = ...,</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#  name = ..., domain = ..., type = ..., but we&#39;ll skip that here for brevity.</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">generate_data_list</span>(</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="fu">list</span>(cort_t, <span class="st">&quot;cortical_thickness&quot;</span>, <span class="st">&quot;neuroimaging&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="fu">list</span>(cort_sa, <span class="st">&quot;cortical_surface_area&quot;</span>, <span class="st">&quot;neuroimaging&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="fu">list</span>(subc_v, <span class="st">&quot;subcortical_volume&quot;</span>, <span class="st">&quot;neuroimaging&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="fu">list</span>(income, <span class="st">&quot;household_income&quot;</span>, <span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="fu">list</span>(pubertal, <span class="st">&quot;pubertal_status&quot;</span>, <span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    <span class="at">uid =</span> <span class="st">&quot;unique_id&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    data_list</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##  [1] row_id                    alpha                    
##  [3] k                         t                        
##  [5] snf_scheme                clust_alg                
##  [7] cont_dist                 disc_dist                
##  [9] ord_dist                  cat_dist                 
## [11] mix_dist                  inc_cortical_thickness   
## [13] inc_cortical_surface_area inc_subcortical_volume   
## [15] inc_household_income      inc_pubertal_status      
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>The resulting columns are:</p>
<ul>
<li><code>row_id</code>: A label to keep track of which row is
which</li>
<li><code>alpha</code>: The alpha (also referred to as sigma or eta)
hyperparameter in SNF</li>
<li><code>k</code>: The K (nearest neighbours) hyperparameter in
similarity matrix calculations and SNF</li>
<li><code>t</code>: The T (number of iterations) hyperparameter used in
SNF</li>
<li><code>snf_scheme</code>: Which SNF “scheme” is being used to convert
the initial provided dataframes into a final fused network (more on this
in the <a href="https://branchlab.github.io/metasnf/articles/a_complete_example.html#snf_scheme">appendix
of the “Less Simple Example” vignette</a>)</li>
<li><code>clust_alg</code>: Which clustering algorithm will be applied
to the final fused network. By default, this varies between the
pre-provided options of (1) spectral clustering with the number of
clusters determined by the eigen-gap heuristic and (2) the same thing
but using the rotation cost heuristic. You can learn more about using
this parameter in the <a href="https://branchlab.github.io/metasnf/articles/clustering_algorithms.html">clustering
algorithnms vignette</a>.</li>
<li>Columns ending in <code>dist</code>: Which distance metric is being
used for the various types of features (more on this in the <a href="https://branchlab.github.io/metasnf/articles/distance_metrics.html">distance
metrics vignette</a>)</li>
<li>Columns starting with <code>inc</code>: Whether or not the
corresponding dataframe will be included (1) or excluded (0) from this
row</li>
</ul>
<p>By varying the values in these columns, we can define distinct SNF
pipelines that should give rise to a broader space of cluster solutions.
The following sections outline how to use
<code>generate_settings_matrix</code> to build a wide range of settings
that will hopefully help you find a subtyping solution useful for your
purposes.</p>
</div>
<div id="adding-random-rows" class="section level2">
<h2>Adding random rows</h2>
<p>When not specifying any parameters beyond the number of rows that are
created, the function will randomly (but sensibly) vary the values in
the matrix.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Through minimums and maximums</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    data_list,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">100</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##   row_id alpha  k  t snf_scheme clust_alg cont_dist disc_dist ord_dist cat_dist
## 1      1   0.3 11 20          2         1         1         1        1        1
## 2      2   0.3 20 20          3         2         1         1        1        1
## 3      3   0.4 65 20          3         2         1         1        1        1
## 4      4   0.7 79 20          2         2         1         1        1        1
## 5      5   0.3 53 20          2         2         1         1        1        1
## 6      6   0.7 57 20          1         2         1         1        1        1
##   mix_dist inc_cortical_thickness inc_cortical_surface_area
## 1        1                      0                         1
## 2        1                      1                         1
## 3        1                      1                         1
## 4        1                      1                         1
## 5        1                      1                         0
## 6        1                      1                         0
##   inc_subcortical_volume inc_household_income inc_pubertal_status
## 1                      1                    1                   1
## 2                      1                    1                   1
## 3                      1                    1                   1
## 4                      1                    1                   1
## 5                      1                    1                   1
## 6                      1                    1                   1</code></pre>
<p>The <code>alpha</code> and <code>k</code> hyperparameters are varied
from 0.3 to 0.8 and 10 to 100 respectively based on suggestion from the
authors of SNF.</p>
<p>The <code>t</code> hyperparameter, which controls how many iterations
of updates occur to the fused network during SNF, stays fixed at 20, by
default. This value (20) has been empirically demonstrated to be
sufficient for achieving convergence of the matrix, and varying it
doesn’t seem to have much relevance to what kinds of cluster solutions
are produced.</p>
<p>The <code>snf_scheme</code> column will vary from 1 to 3, which
outlines the 3 differente schemes that are available.</p>
<p>The <code>clust_alg</code> column will vary randomly between (1)
spectral clustering using the eigen-gap heuristic and (2) spectral
clustering using the rotation cost heuristic by default.</p>
<p>The distance columns will always be 1 by default, as they will just
use the default distance metrics of simple Euclidean for anything
numeric and Gower’s distance for anything mixed or categorical.</p>
<p>Controlling the scheme, the clustering algorithms, and the distance
metrics are discussed in more details in separate vignettes linked to
above. Controlling the remaining options are shown below.</p>
</div>
<div id="alpha-k-and-t" class="section level2">
<h2>Alpha, k, and t</h2>
<p>You can control any of these parameters either by providing a vector
of values you’d like to randomly sample from or by specifying a minimum
and maximum range.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Through minimums and maximums</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    data_list,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">100</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">min_k =</span> <span class="dv">10</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">max_k =</span> <span class="dv">60</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="at">min_alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="at">max_alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    <span class="at">min_t =</span> <span class="dv">15</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    <span class="at">max_t =</span> <span class="dv">30</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in add_settings_matrix_rows(settings_matrix = settings_matrix_base, :
## The original SNF paper recommends a t between 10 to 20. Empirically, setting t
## above 20 is always sufficient for SNF to converge. This warning is raised
## anytime a user tries to set a t value smaller than 10 or larger than 20.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Through specific value sampling</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    data_list,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">20</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="at">k_values =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>),</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">alpha_values =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.8</span>),</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="at">t_values =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in add_settings_matrix_rows(settings_matrix = settings_matrix_base, :
## The original SNF paper recommends a t between 10 to 20. Empirically, setting t
## above 20 is always sufficient for SNF to converge. This warning is raised
## anytime a user tries to set a t value smaller than 10 or larger than 20.</code></pre>
</div>
<div id="inclusion-columns" class="section level2">
<h2>Inclusion columns</h2>
<p>Bounds on the number of input dataframes removed as well as the way
in which the number removed is chosen can be controlled.</p>
<p>By default, <code>generate_settings_matrix</code> will pick a random
value between 0 and 1 less than the total number of available dataframes
based on an exponential probability distribution. The exponential
distribution makes it so that it is very likely that a small number of
dataframes will be dropped and much less likely that a large number of
dataframes will be dropped.</p>
<p>You can control the distribution by changing the
<code>dropout_dist</code> value to “uniform” (which will result in a
much higher number of dataframes being dropped on average) or “none”
(which will result in no dataframes being dropped).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Exponential dropping</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    data_list,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">20</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="at">dropout_dist =</span> <span class="st">&quot;exponential&quot;</span> <span class="co"># the default behaviour</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##   row_id alpha  k  t snf_scheme clust_alg cont_dist disc_dist ord_dist cat_dist
## 1      1   0.5 39 20          2         2         1         1        1        1
## 2      2   0.7 13 20          2         1         1         1        1        1
## 3      3   0.5 75 20          3         2         1         1        1        1
## 4      4   0.5 20 20          3         2         1         1        1        1
## 5      5   0.5 25 20          2         2         1         1        1        1
## 6      6   0.6 49 20          3         1         1         1        1        1
##   mix_dist inc_cortical_thickness inc_cortical_surface_area
## 1        1                      1                         1
## 2        1                      1                         1
## 3        1                      1                         0
## 4        1                      1                         1
## 5        1                      1                         1
## 6        1                      1                         1
##   inc_subcortical_volume inc_household_income inc_pubertal_status
## 1                      1                    1                   1
## 2                      1                    1                   1
## 3                      1                    1                   1
## 4                      1                    1                   1
## 5                      1                    1                   1
## 6                      1                    1                   1</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Uniform dropping</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    data_list,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">20</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">dropout_dist =</span> <span class="st">&quot;uniform&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##   row_id alpha  k  t snf_scheme clust_alg cont_dist disc_dist ord_dist cat_dist
## 1      1   0.3 79 20          3         2         1         1        1        1
## 2      2   0.8 83 20          2         1         1         1        1        1
## 3      3   0.5 45 20          2         2         1         1        1        1
## 4      4   0.4 13 20          2         1         1         1        1        1
## 5      5   0.6 89 20          1         2         1         1        1        1
## 6      6   0.4 35 20          2         2         1         1        1        1
##   mix_dist inc_cortical_thickness inc_cortical_surface_area
## 1        1                      1                         1
## 2        1                      0                         0
## 3        1                      1                         1
## 4        1                      1                         1
## 5        1                      1                         1
## 6        1                      1                         1
##   inc_subcortical_volume inc_household_income inc_pubertal_status
## 1                      0                    0                   1
## 2                      0                    1                   1
## 3                      0                    1                   1
## 4                      0                    0                   1
## 5                      0                    1                   1
## 6                      1                    0                   1</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># No dropping</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    data_list,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">20</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="at">dropout_dist =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##   row_id alpha  k  t snf_scheme clust_alg cont_dist disc_dist ord_dist cat_dist
## 1      1   0.3 74 20          1         2         1         1        1        1
## 2      2   0.3 49 20          1         1         1         1        1        1
## 3      3   0.3 14 20          1         1         1         1        1        1
## 4      4   0.8 64 20          1         2         1         1        1        1
## 5      5   0.6 32 20          3         1         1         1        1        1
## 6      6   0.8 88 20          1         1         1         1        1        1
##   mix_dist inc_cortical_thickness inc_cortical_surface_area
## 1        1                      1                         1
## 2        1                      1                         1
## 3        1                      1                         1
## 4        1                      1                         1
## 5        1                      1                         1
## 6        1                      1                         1
##   inc_subcortical_volume inc_household_income inc_pubertal_status
## 1                      1                    1                   1
## 2                      1                    1                   1
## 3                      1                    1                   1
## 4                      1                    1                   1
## 5                      1                    1                   1
## 6                      1                    1                   1</code></pre>
<p>The bounds on the number of dataframes that can be dropped can be
controlled using the <code>min_removed_inputs</code> and
<code>max_removed_inputs</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    data_list,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">20</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">min_removed_inputs =</span> <span class="dv">3</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># No row will exclude fewer than 3 dataframes during SNF</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">head</span>(settings_matrix)</span></code></pre></div>
<pre><code>##   row_id alpha  k  t snf_scheme clust_alg cont_dist disc_dist ord_dist cat_dist
## 1      1   0.3 31 20          3         1         1         1        1        1
## 2      2   0.4 33 20          2         1         1         1        1        1
## 3      3   0.8 79 20          2         2         1         1        1        1
## 4      4   0.6 40 20          3         2         1         1        1        1
## 5      5   0.6 57 20          2         1         1         1        1        1
## 6      6   0.7 75 20          3         1         1         1        1        1
##   mix_dist inc_cortical_thickness inc_cortical_surface_area
## 1        1                      0                         1
## 2        1                      1                         0
## 3        1                      1                         0
## 4        1                      1                         0
## 5        1                      0                         1
## 6        1                      0                         0
##   inc_subcortical_volume inc_household_income inc_pubertal_status
## 1                      0                    0                   1
## 2                      1                    0                   0
## 3                      0                    0                   1
## 4                      0                    0                   1
## 5                      0                    1                   0
## 6                      1                    1                   0</code></pre>
</div>
<div id="grid-searching" class="section level2">
<h2>Grid searching</h2>
<p>If you are interested in grid searching over perhaps just a specific
set of alpha and k values, you may want to consider varying those
parameters and keeping everything else fixed:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    data_list,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">10</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">alpha_values =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="at">k_values =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>),</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="at">dropout_dist =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="assembling-a-settings_matrix-in-pieces" class="section level2">
<h2>Assembling a settings_matrix in pieces</h2>
<p>Rather than varying everything equally all at once, you may be
interested in looking at “chunks” of solution spaces that are based on
distinct settings matrices.</p>
<p>For example, you may want to look at 100 solutions generated with k =
50 and look at another 100 solutions generated with k = 80. You can
absolutely build two separate settings matrices, but you can also build
up a single matrix in parts using the
<code>add_settings_matrix_rows</code> function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">generate_settings_matrix</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>    data_list,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">50</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">k_values =</span> <span class="dv">50</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>settings_matrix <span class="ot">&lt;-</span> <span class="fu">add_settings_matrix_rows</span>(</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    settings_matrix,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">50</span>,</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="at">k_values =</span> <span class="dv">80</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="fu">dim</span>(settings_matrix)</span></code></pre></div>
<pre><code>## [1] 100  16</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>settings_matrix<span class="sc">$</span><span class="st">&quot;k&quot;</span></span></code></pre></div>
<pre><code>##   [1] 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
##  [26] 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
##  [51] 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80
##  [76] 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80 80</code></pre>
</div>
<div id="manual-adjustments" class="section level2">
<h2>Manual adjustments</h2>
<p>Don’t forget that the settings matrix is just a dataframe. You can
always go in and modify things as you wish, but you do risk generating
duplicate or invalid rows that the package functions would have
prevented.</p>
</div>
<div id="matrix-building-failed" class="section level2">
<h2>“Matrix building failed”</h2>
<p><code>generate_settings_matrix</code> will never build duplicate
rows. A consequence of this is that if you request a very large number
of rows over a very small range of possible values to vary over, it will
be impossible for the matrix to be built. For example, there’s no way to
generate 10 unique rows when the only thing allowed to vary is which
clustering algorithm (1 or 2) is used - only 2 rows could ever be
created.</p>
<p>If you encounter the error “Matrix building failed”, try to generate
fewer rows or to be a little less strict with what values are
allowed.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
