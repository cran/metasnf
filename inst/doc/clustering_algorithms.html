<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Clustering Algorithms</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Clustering Algorithms</h1>


<div id="TOC">
<ul>
<li><a href="#clustering-algorithms" id="toc-clustering-algorithms">Clustering Algorithms</a>
<ul>
<li><a href="#default-clustering" id="toc-default-clustering">Default
clustering</a></li>
<li><a href="#other-built-in-clustering-options" id="toc-other-built-in-clustering-options">Other built-in clustering
options</a></li>
<li><a href="#structure-of-a-clustering-algorithm-function" id="toc-structure-of-a-clustering-algorithm-function">Structure of a
clustering algorithm function</a></li>
<li><a href="#non-automated-clustering" id="toc-non-automated-clustering">Non-automated clustering</a></li>
<li><a href="#example-of-non-automated-clustering-dbscan" id="toc-example-of-non-automated-clustering-dbscan">Example of
non-automated clustering: DBSCAN</a></li>
</ul></li>
</ul>
</div>

<style>
div.aside { background-color:#fff2e6; }
</style>
<p>Download a copy of the vignette to follow along here: <a href="https://raw.githubusercontent.com/BRANCHlab/metasnf/main/vignettes/clustering_algorithms.Rmd">clustering_algorithms.Rmd</a></p>
<div id="clustering-algorithms" class="section level2">
<h2>Clustering Algorithms</h2>
<p>SNF produces a single similarity matrix that is meant to describe how
similar all the observations are to each other across all the provided
input features. Dividing that similarity matrix into subtypes requires
can be done using clustering algorithms. Within the <code>metasnf</code>
package, clustering is done by default using the spectral clustering
algorithm (as implemented by the original SNFtool package). The code
below goes over what the default clustering looks like.</p>
<div id="default-clustering" class="section level3">
<h3>Default clustering</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(metasnf)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>dl <span class="ot">&lt;-</span> <span class="fu">data_list</span>(</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="fu">list</span>(subc_v, <span class="st">&quot;subcortical_volume&quot;</span>, <span class="st">&quot;neuroimaging&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="fu">list</span>(income, <span class="st">&quot;household_income&quot;</span>, <span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="fu">list</span>(pubertal, <span class="st">&quot;pubertal_status&quot;</span>, <span class="st">&quot;demographics&quot;</span>, <span class="st">&quot;continuous&quot;</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="fu">list</span>(anxiety, <span class="st">&quot;anxiety&quot;</span>, <span class="st">&quot;behaviour&quot;</span>, <span class="st">&quot;ordinal&quot;</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="fu">list</span>(depress, <span class="st">&quot;depressed&quot;</span>, <span class="st">&quot;behaviour&quot;</span>, <span class="st">&quot;ordinal&quot;</span>),</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="at">uid =</span> <span class="st">&quot;unique_id&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">snf_config</span>(</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    <span class="at">n_solutions =</span> <span class="dv">5</span>,</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="at">max_k =</span> <span class="dv">40</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; ℹ No clustering functions specified. Using defaults.</span></span></code></pre></div>
<p>The clustering functions that can be used are stored within the
<em>clustering functions list</em> (<code>clust_fns_list</code> object)
of the config, while the reference to which of those functions will be
used for a particular solution is stored in the <em>settings data
frame</em> (<code>settings_df</code> object) of the config:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Available functions</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>sc<span class="sc">$</span><span class="st">&quot;clust_fns_list&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; [1] spectral_eigen</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; [2] spectral_rot</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Which functions will be used</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>sc<span class="sc">$</span><span class="st">&quot;settings_df&quot;</span><span class="sc">$</span><span class="st">&quot;clust_alg&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 2 1 2</span></span></code></pre></div>
<p>The “1” corresponds to spectral clustering using the eigen-gap
heuristic to determine the number of clusters, while the “2” corresponds
to spectral clustering using the rotation cost heuristic to determine
the number of clusters. You can find this information by running
<code>?snf_config</code>.</p>
</div>
<div id="other-built-in-clustering-options" class="section level3">
<h3>Other built-in clustering options</h3>
<p>Currently, the available clustering algorithms are:</p>
<ul>
<li><code>spectral_eigen</code></li>
<li><code>spectral_rot</code></li>
<li><code>spectral_two</code></li>
<li><code>spectral_three</code></li>
<li><code>spectral_four</code></li>
<li><code>spectral_five</code></li>
<li><code>spectral_six</code></li>
<li><code>spectral_seven</code></li>
<li><code>spectral_eight</code></li>
</ul>
<p>The first two are the defaults, and the remaining ones specifically
use 2, 3, 4, … and so on as their number of clusters rather than
whatever is calculated by a separate heuristic function.</p>
<p>To make use of any of these alternative algorithms, you’ll need to
customize the <code>clust_fns_list</code> generated during the call to
<code>snf_config()</code>. Here’s what that looks like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># The default list:</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">snf_config</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">n_solutions =</span> <span class="dv">5</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">use_default_clust_fns =</span> <span class="cn">TRUE</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>sc<span class="sc">$</span><span class="st">&quot;clust_fns_list&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; [1] spectral_eigen</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; [2] spectral_rot</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># Adding algorithms provided by the package</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">snf_config</span>(</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="at">n_solutions =</span> <span class="dv">5</span>,</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="at">clust_fns =</span> <span class="fu">list</span>(</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>        <span class="st">&quot;two_cluster_spectral&quot;</span> <span class="ot">=</span> spectral_two,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>        <span class="st">&quot;five_cluster_spectral&quot;</span> <span class="ot">=</span> spectral_five</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    ),</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>    <span class="at">use_default_clust_fns =</span> <span class="cn">TRUE</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co"># Note that this one has the default algorithms as well as the newly added ones</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>sc<span class="sc">$</span><span class="st">&quot;clust_fns_list&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; [1] spectral_eigen</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; [2] spectral_rot</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt; [3] two_cluster_spectral</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt; [4] five_cluster_spectral</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co"># This list has only the newly added ones</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">snf_config</span>(</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>    <span class="at">n_solutions =</span> <span class="dv">5</span>,</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>    <span class="at">clust_fns =</span> <span class="fu">list</span>(</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>        <span class="st">&quot;two_cluster_spectral&quot;</span> <span class="ot">=</span> spectral_two,</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>        <span class="st">&quot;five_cluster_spectral&quot;</span> <span class="ot">=</span> spectral_five</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>    )</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>)</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>sc<span class="sc">$</span><span class="st">&quot;clust_fns_list&quot;</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt; [1] two_cluster_spectral</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt; [2] five_cluster_spectral</span></span></code></pre></div>
<p>When looking at the clustering functions values in the settings part
of an SNF config, you can see that there is some random fluctuation
between 1 and 2:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>sc</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; Settings Data Frame:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;                         1    2    3    4    5</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; SNF hyperparameters:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; alpha                 0.4  0.8  0.4  0.7  0.3</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; k                      46   75   18   64   16  </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; t                      20   20   20   20   20  </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; SNF scheme:</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;                         2    3    3    1    1  </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Clustering functions:</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;                         2    2    2    1    1  </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Distance functions:</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; CNT                     1    1    1    1    1  </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; DSC                     1    1    1    1    1  </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; ORD                     1    1    1    1    1  </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; CAT                     1    1    1    1    1  </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; MIX                     1    1    1    1    1  </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Component dropout:</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; subcortical_volume      ✔    ✔    ✔    ✔    ✔  </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; household_income        ✔    ✔    ✔    ✔    ✔  </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; pubertal_status         ✔    ✔    ✔    ✔    ✔  </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; anxiety                 ✔    ✔    ✔    ✔    ✖  </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; depressed               ✔    ✔    ✔    ✔    ✔  </span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; Distance Functions List:</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; Continuous (1):</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; [1] euclidean_distance</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; Discrete (1):</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; [1] euclidean_distance</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; Ordinal (1):</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; [1] euclidean_distance</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; Categorical (1):</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; [1] gower_distance</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; Mixed (1):</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; [1] gower_distance</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; Clustering Functions List:</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt; [1] two_cluster_spectral</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt; [2] five_cluster_spectral</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; Weights Matrix:</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt; Weights defined for 5 cluster solutions.</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; $ smri_vol_scs_cbwmatterlh 1, 1, 1, 1, 1 </span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt; $ smri_vol_scs_ltventriclelh 1, 1, 1, 1, 1 </span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; $ smri_vol_scs_inflatventlh 1, 1, 1, 1, 1 </span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co">#&gt; $ smri_vol_scs_crbwmatterlh 1, 1, 1, 1, 1 </span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="co">#&gt; $ smri_vol_scs_crbcortexlh 1, 1, 1, 1, 1 </span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="co">#&gt; …and 29 more features.</span></span></code></pre></div>
<p>The settings segment contains pointers to which clustering function
to use, while the clustering functions list stores the actual
functions.</p>
<p>When you are satisfied with the clustering functions you’ve
specified, you can try them out with a typical call to
<code>batch_snf()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>sol_df <span class="ot">&lt;-</span> <span class="fu">batch_snf</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">sc =</span> sc</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="structure-of-a-clustering-algorithm-function" class="section level3">
<h3>Structure of a clustering algorithm function</h3>
<p>Any clustering algorithm can be used as long as you can write a
function for it with the following format:</p>
<ol style="list-style-type: decimal">
<li>Takes a single N*N similarity_matrix as its only input</li>
<li>Returns a named list:
<ul>
<li>The first item (named “solution”) is a single N-dimensional vector
of numbers corresponding to the observations in the similarity
matrix</li>
<li>The second item (named “nclust”) is a single integer indicating the
number of clusters that the algorithm is supposed to have generated</li>
</ul></li>
</ol>
<p>Note that the number of clusters parameter fed into
<code>SNFtool::spectralClustering</code> doesn’t always return a
solution containing that many clusters. For example, an affinity matrix
where every observation is identical to all other observations could not
yield more than a 1 cluster solution, regardless of how many clusters
were requested.</p>
<p>Also note that the function should <em>not</em> take number of
clusters as an argument - if you want to explore the same clustering
algorithm with a varying number of clusters, you’ll need to provide a
separate function for each number of clusters you’re interested in.</p>
<p>The source code for the two default functions are shown below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Default clustering algorithm #1</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>spectral_eigen <span class="ot">&lt;-</span> <span class="cf">function</span>(similarity_matrix) {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    estimated_n <span class="ot">&lt;-</span> <span class="fu">estimate_nclust_given_graph</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>        <span class="at">W =</span> similarity_matrix,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>        <span class="at">NUMC =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    )</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    nclust_estimate <span class="ot">&lt;-</span> estimated_n<span class="sc">$</span><span class="st">`</span><span class="at">Eigen-gap best</span><span class="st">`</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    solution <span class="ot">&lt;-</span> SNFtool<span class="sc">::</span><span class="fu">spectralClustering</span>(</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>        similarity_matrix,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>        nclust_estimate</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    )</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    <span class="fu">return</span>(solution)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>}</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Default clustering algorithm #2</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>spectral_rot <span class="ot">&lt;-</span> <span class="cf">function</span>(similarity_matrix) {</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    estimated_n <span class="ot">&lt;-</span> <span class="fu">estimate_nclust_given_graph</span>(</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>        <span class="at">W =</span> similarity_matrix,</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>        <span class="at">NUMC =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>    )</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>    nclust_estimate <span class="ot">&lt;-</span> estimated_n<span class="sc">$</span><span class="st">`</span><span class="at">Rotation cost best</span><span class="st">`</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>    solution <span class="ot">&lt;-</span> SNFtool<span class="sc">::</span><span class="fu">spectralClustering</span>(</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>        similarity_matrix,</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>        nclust_estimate</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>    )</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="fu">return</span>(solution)</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="non-automated-clustering" class="section level3">
<h3>Non-automated clustering</h3>
<p>You can also extract the similarity matrices for each computed row of
the settings data frame and perform the clustering more “manually”. This
is particularly useful for clustering procedures where the transition
from a similarity matrix to the final solution requires human
intervention (e.g., judgement for clustering hyperparameters).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>sol_df <span class="ot">&lt;-</span> <span class="fu">batch_snf</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    dl,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    sc,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="at">return_sim_mats =</span> <span class="cn">TRUE</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Similarity matrices are in the list below:</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>similarity_matrices <span class="ot">&lt;-</span> <span class="fu">sim_mats_list</span>(sol_df)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="fu">length</span>(similarity_matrices)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">dim</span>(similarity_matrices[[<span class="dv">1</span>]])</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; [1] 87 87</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co"># Your manual clustering goes here...</span></span></code></pre></div>
</div>
<div id="example-of-non-automated-clustering-dbscan" class="section level3">
<h3>Example of non-automated clustering: DBSCAN</h3>
<p>Let’s say we wanted to cluster our similarity matrices with DBSCAN
rather than with spectral clustering. Start by taking a look at the
documentation for running the DBSCAN function from the dbscan R package
<a href="https://cran.r-project.org/package=dbscan">https://cran.r-project.org/package=dbscan</a>:</p>
<p>DBSCAN is about as challenging as custom clustering can get, as the
suggested process for specifying the number of clusters is recommended
to involve human intervention and the function itself operates on
dissimilarity (distance) matrices rather than similarity matrices.</p>
<p>Below is a slightly adjusted form of their <code>dbscan</code>
example. You can work through this on your own.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="do">## Example 1: use dbscan on the iris data set</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>iris_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(iris)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">## Find suitable DBSCAN parameters:</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="do">## 1. We use minPts = dim + 1 = 5 for iris. A larger value can also be used.</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="do">## 2. We inspect the k-NN distance plot for k = minPts - 1 = 4</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">kNNdistplot</span>(iris, <span class="at">minPts =</span> <span class="dv">5</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="do">## Noise seems to start around a 4-NN distance of .7</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>.<span class="dv">7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(iris_dist, <span class="at">eps =</span> <span class="fl">0.7</span>, <span class="at">minPts =</span> <span class="dv">5</span>)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># The 1 is added to ensure that those with no cluster (cluster 0) are still</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co"># plotted.</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">pairs</span>(iris, <span class="at">col =</span> results<span class="sc">$</span>cluster <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<p>After some poking around, you will often see people mentioning that
DBSCAN just isn’t meant to be automated. You need to look at your data
to have a good idea of what values to use for the hyperparameters
<code>eps</code> and <code>minPts</code>. When you need to get involved
manually, that’s the perfect time to manage the many similarity matrices
you’ve created with <code>batch_snf</code> through meta clustering.
Generate a wide range of similarity matrices and apply meta clustering
to find a few representative similarity matrices. One way to do this
would be based on how the spectral-clustering derived solutions end up
clustering together (see <a href="https://branchlab.github.io/metasnf/articles/a_complete_example.html#examining-meta-clusters">example</a>).
Then take the corresponding affinity matrices and go through the dbscan
clustering process manually.</p>
<p>Based on <code>?dbscan</code>, it looks like the function can accept
precomputed distance matrices (instead of
<code>precomputed_nn_object</code>s) as long as they actually are
<code>dist</code> objects (which can be done using the
<code>as.dist()</code> function). There are many formulas to convert
between similarity matrices and distance matrices which have their own
pros and cons. Here, we’ll use a common approach of
<code>distance = max(similarity) - similarity</code>. Whichever matrix
values had the maximum similarity will now have a distance of 0, and
whichever matrix values had the lowest amount of similarity will have
distance values that are the closest to the former maximum similarity
value.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dbscan&#39;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:stats&#39;:</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;     as.dendrogram</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>dl <span class="ot">&lt;-</span> <span class="fu">data_list</span>(</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>        <span class="at">data =</span> expression_df,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">&quot;genes_1_and_2_exp&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>        <span class="at">domain =</span> <span class="st">&quot;gene_expression&quot;</span>,</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    ),</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>        <span class="at">data =</span> methylation_df,</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">&quot;genes_1_and_2_meth&quot;</span>,</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>        <span class="at">domain =</span> <span class="st">&quot;gene_methylation&quot;</span>,</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>    ),</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>    <span class="at">uid =</span> <span class="st">&quot;patient_id&quot;</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>)</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">snf_config</span>(</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>    <span class="at">n_solutions =</span> <span class="dv">5</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>)</span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; ℹ No distance functions specified. Using defaults.</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; ℹ No clustering functions specified. Using defaults.</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>sol_df <span class="ot">&lt;-</span> <span class="fu">batch_snf</span>(</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a>    <span class="at">dl =</span> dl,</span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>    <span class="at">sc =</span> sc,</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>    <span class="at">return_sim_mats =</span> <span class="cn">TRUE</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>)</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>similarity_matrices <span class="ot">&lt;-</span> <span class="fu">sim_mats_list</span>(sol_df)</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>representative_sm <span class="ot">&lt;-</span> similarity_matrices[[<span class="dv">1</span>]]</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a>representative_sms <span class="ot">&lt;-</span> similarity_matrices[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a>distance_matrix1 <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(</span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>    <span class="fu">max</span>(representative_sm) <span class="sc">-</span> representative_sm</span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a>)</span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="fu">kNNdistplot</span>(</span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a>    distance_matrix1,</span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a>    <span class="at">minPts =</span> <span class="dv">10</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a>)</span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="do">## Maybe there?</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.4872</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>dbscan_results <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(distance_matrix1, <span class="at">eps =</span> <span class="fl">0.4872</span>, <span class="at">minPts =</span> <span class="dv">10</span>)<span class="sc">$</span><span class="st">&quot;cluster&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>spectral_results <span class="ot">&lt;-</span> <span class="fu">t</span>(sol_df[<span class="dv">1</span>, ])[, <span class="dv">2</span>]</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>dbscan_vs_spectral <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    <span class="at">dbscan =</span> dbscan_results,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="at">spectral =</span> spectral_results</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">ggplot</span>(dbscan_vs_spectral, <span class="fu">aes</span>(<span class="at">x =</span> dbscan, <span class="at">y =</span> spectral)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There’s one bold lie in the code chunk above, which is how easy it
was to find that magic hyperparameter combination of
<code>minPts = 10</code> and <code>eps = 0.487</code> parameter value of
0.4872. It wasn’t based off of the visual inspection of the kNNdistplot,
but rather through a lot of trial and error.</p>
<p>Something along the lines of:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.485</span>, <span class="fl">0.488</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(distance_matrix1, <span class="at">eps =</span> i, <span class="at">minPts =</span> <span class="dv">10</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(results<span class="sc">$</span><span class="st">&quot;cluster&quot;</span>)) <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>        <span class="fu">print</span>(i)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    }</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>}</span></code></pre></div>
<p>In this specific instance, those hyperparameters are incredibly
sensitive - a slight change will get very different results. That is
likely due to the shape of the actual data being clustered. Your mileage
may vary.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
